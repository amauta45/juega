<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Juego Final</title>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  overflow: hidden;
  font-family: Arial, sans-serif;
}

/* ESCENARIO */
.game {
  position: relative;
  width: 100vw;
  height: 100vh;
  background: url("https://i.pinimg.com/1200x/0c/8a/01/0c8a01297970f5d6efb7cbb5b280d246.jpg")
              center/cover no-repeat;
}

/* VIDAS */
.lives {
  position: absolute;
  top: 45px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 24px;
  z-index: 10;
}

/* BARRA */
.progress {
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: 340px;
  height: 22px;
  border: 2px solid white;
  border-radius: 12px;
  background: rgba(0,0,0,0.4);
  z-index: 10;
}

.fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(to right, pink, hotpink);
  border-radius: 10px;
}

/* SUELO */
.ground {
  position: absolute;
  bottom: 80px;
  width: 100%;
  height: 10px;
  background: rgba(0,0,0,0.6);
}

/* PERSONAJE */
.player {
  position: absolute;
  bottom: 90px;
  left: 80px;
  width: 60px;
  height: 60px;
  background: url("https://cdna.artstation.com/p/assets/images/images/047/256/128/original/benjamin-parga-oso-3-4-45ms.gif?1647163873")
              center/contain no-repeat;
}

/* OBST√ÅCULOS */
.obstacle {
  position: absolute;
  bottom: 80px;
  width: 40px;
  height: 60px;
  background: url("https://mcgamba.hotglue.me/?Page4.head.155907191411")
              center/contain no-repeat;
}
</style>
</head>

<body>

<div class="game" id="game">
  <div class="progress">
    <div class="fill" id="fill"></div>
  </div>
  <div class="lives" id="lives">‚ù§Ô∏è‚ù§Ô∏è</div>
  <div class="ground"></div>
  <div class="player" id="player"></div>
</div>

<script>
const player = document.getElementById("player");
const fill = document.getElementById("fill");
const game = document.getElementById("game");
const livesUI = document.getElementById("lives");

/* F√çSICA */
let y = 0;
let velocity = 0;
let gravity = 0.8;
let jumpForce = 15;
let jumping = false;

/* JUEGO */
let speed = 4;
let obstacles = [];
let finished = false;

/* VIDAS */
let lives = 2;

/* PROGRESO */
let distance = 0;
const maxDistance = 7500; 

/* SALTAR */
document.addEventListener("keydown", e => {
  if (e.code === "Space") jump();
});
document.addEventListener("touchstart", jump);

function jump() {
  if (!jumping && !finished) {
    velocity = jumpForce;
    jumping = true;
  }
}

/* CREAR OBST√ÅCULOS */
setInterval(() => {
  if (finished) return;
  const obs = document.createElement("div");
  obs.className = "obstacle";
  obs.style.left = "100%";
  game.appendChild(obs);
  obstacles.push(obs);
}, 1600);

/* LOOP PRINCIPAL */
function update() {
  if (finished) return;

  /* SALTO */
  y += velocity;
  velocity -= gravity;
  if (y <= 0) {
    y = 0;
    jumping = false;
  }
  player.style.bottom = 90 + y + "px";

  /* PROGRESO */
  distance += speed;
  let progress = (distance / maxDistance) * 100;
  fill.style.width = Math.min(progress, 100) + "%";

  /* FINAL POR BARRA */
  if (progress >= 100) {
    win();
    return;
  }

  /* OBST√ÅCULOS */
  obstacles.forEach((obs, i) => {
    obs.style.left = obs.offsetLeft - speed + "px";

    if (obs.offsetLeft < -60) {
      obs.remove();
      obstacles.splice(i, 1);
    }

    if (collision(player, obs)) hit(obs);
  });

  requestAnimationFrame(update);
}

update();

/* COLISI√ìN JUSTA */
function collision(a, b) {
  const r1 = a.getBoundingClientRect();
  const r2 = b.getBoundingClientRect();
  return (
    r1.left + 10 < r2.right - 10 &&
    r1.right - 10 > r2.left + 10 &&
    r1.top + 10 < r2.bottom - 10 &&
    r1.bottom - 10 > r2.top + 10
  );
}

/* GOLPE */
function hit(obs) {
  obs.remove();
  obstacles = obstacles.filter(o => o !== obs);
  lives--;
  livesUI.textContent = "‚ù§Ô∏è".repeat(lives);

  if (lives <= 0) {
    alert("üí• Sin vidas‚Ä¶ vuelves al inicio");
    resetGame();
  }
}

/* REINICIAR */
function resetGame() {
  lives = 2;
  livesUI.textContent = "‚ù§Ô∏è‚ù§Ô∏è";
  distance = 0;
  fill.style.width = "0%";
  obstacles.forEach(o => o.remove());
  obstacles = [];
}

/* GANAR */
function win() {
  finished = true;
  alert("üéâ ¬°LO LOGRASTE! Ahora recibir√°s tu recompensa üíñ");
  location.href = "carta.html";
}
</script>

</body>
</html>



